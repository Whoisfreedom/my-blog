{"version":3,"sources":["webpack:///webpack/bootstrap 5adfb0b00c3ed1120a49","webpack:///external \"mongoose\"","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///external \"ioredis\"","webpack:///external \"koa-router\"","webpack:///./nuxt.config.js","webpack:///./server/mongo/mongoose.js","webpack:///./server/routers/articles.js","webpack:///./server/routers/comment.js","webpack:///./server/routers/users.js","webpack:///external \"koa\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"koa2-cors\"","webpack:///external \"nuxt\"","webpack:///./server/codeList/codeList.js","webpack:///./server/models/article.server.model.js","webpack:///./server/models/comment.server.model.js","webpack:///./server/models/user.server.model.js","webpack:///external \"regenerator-runtime\"","webpack:///./server/index.js"],"names":["module","exports","head","title","meta","charset","name","content","hid","link","rel","type","href","plugins","css","src","loading","color","build","extend","config","ctx","isClient","rules","push","enforce","test","loader","exclude","mongoose","require","db","connect","Router","Redis","redis","Article","model","connection","on","console","error","bind","once","log","router","post","next","req","request","body","get","err","result","loginSessionId","nowTime","Date","article","Aid","getTime","toString","innerHtml","createTime","saveerr","save","bobo","status","code","errorMsg","header","find","art","sort","limit","res","resArr","map","item","q","pattern","RegExp","skip","pageIndex","pageSize","total","totalLenth","length","list","remove","ok","Comment","comment","bindAid","text","codeList","User","userName","users","loginuser","findUser","passWord","set","uid","default","articleTypeList","codeKey","codeName","ArticleSchema","Schema","Number","String","CommentSchema","UserSchema","lastLogin","app","use","bodyParser","cors","origin","port","process","env","PORT","dev","nuxt","builder","startRender","Promise","resolve","reject","render","promise","then","catch","routes","articles","comments","listen","start"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 18);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5adfb0b00c3ed1120a49","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 1\n// module chunks = 0","module.exports = require(\"ioredis\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ioredis\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 3\n// module chunks = 0","module.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: '我的博客',\n    meta: [\n      { charset: 'utf-8' },\n      { name: 'viewport', content: 'width=device-width, initial-scale=1' },\n      { hid: 'description', name: 'description', content: 'Nuxt.js project' }\n    ],\n    link: [\n      { rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\n    ]\n  },\n  /*\n  ** Global JS\n  */\n  plugins: ['~plugins/myHttp.js'],\n  /*\n  ** Global CSS\n  */\n  css:[\n    {src:'~assets/css/main.css'}\n  ],\n  /*\n  ** Customize the progress-bar color\n  */\n  loading: { color: '#3B8070' },\n  /*\n   ** Build configuration\n   */\n  build: {\n    /*\n     ** Run ESLINT on save\n     */\n    extend (config, ctx) {\n      if (ctx.isClient) {\n        config.module.rules.push({\n          enforce: 'pre',\n          test: /\\.(js|vue)$/,\n          loader: 'eslint-loader',\n          exclude: /(node_modules)/\n        })\n      }\n    },\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","var mongoose = require('mongoose');\r\n\r\nmodule.exports = function(){\r\n  var db = mongoose.connect(\"mongodb://localhost:27017/test\", {\"useNewUrlParser\": true});\r\n\r\n  require('../models/user.server.model.js');\r\n  require('../models/article.server.model.js');\r\n  require('../models/comment.server.model.js');\r\n  return db;\r\n};\n\n\n// WEBPACK FOOTER //\n// ./server/mongo/mongoose.js","var Router = require('koa-router')\r\nvar Redis = require('ioredis')\r\nvar redis = new Redis();\r\nvar mongoose = require('mongoose');\r\n// 引入 mongoose 配置文件\r\nvar Article = mongoose.model('Article');\r\nvar db = mongoose.connection;\r\ndb.on('error', console.error.bind(console, 'connection error:'));\r\ndb.once('open', function() {\r\n  console.log('mongo success')\r\n});\r\n\r\nvar router = new Router()\r\n//创建文章\r\nrouter.post('/createArticle', async function(ctx, next){\r\n\tlet req = ctx.request.body\r\n\tlet loginSessionId = await redis.get('loginSessionId', function (err, result) {\r\n        return result\r\n      });\r\n\tif(req.loginSessionId && req.loginSessionId === loginSessionId){\r\n\t\t//判断是否当前登录用户，如果是的话就可以操作\r\n\t\tlet nowTime = new Date;\r\n\t\tvar article = new Article({ \r\n\t\t  Aid: nowTime.getTime().toString(),\r\n\t\t  title: req.title,\r\n\t\t  innerHtml: req.innerHtml,\r\n\t\t  createTime: nowTime, \r\n\t\t  type: req.type\r\n\t\t});\r\n\t\tlet saveerr = article.save(function (err, bobo) {\r\n\t\t  if (err) return console.error(err);\r\n\t\t});\r\n\t\tif(saveerr){\r\n\t\t\tctx.status = 200\r\n\t\t\tctx.body = {\r\n\t\t        code: -1,\r\n\t\t        errorMsg: saveerr\r\n\t\t    }\r\n\t\t}else{\r\n\t\t\tctx.status = 200\r\n\t\t\tctx.body = {\r\n\t\t        code: 0,\r\n\t\t        errorMsg: '新增成功'\r\n\t\t    }\r\n\t\t}\r\n\t}else{\r\n\t\tctx.status = 200\r\n\t\tctx.body = {\r\n\t        code: -999,\r\n\t        errorMsg: '当前未登录，请重新登录'\r\n\t    }\r\n\t}\t\r\n});\r\n// 首页获取前10文章\r\nrouter.post('/getArticles', async function(ctx, next){\r\n  if(ctx.request.header.connection != 'close'){\r\n    let res = await Article.find(function (err, art) {\r\n      return art\r\n    }).sort({Aid:-1}).limit(10)\r\n    let resArr = res.map((item) => {\r\n    \treturn {\r\n    \t  Aid: item.Aid,\r\n\t      createTime: item.createTime,\r\n\t      title: item.title,\r\n\t      type: item.type\r\n    \t}\r\n\t})\r\n    ctx.status = 200\r\n    ctx.body = resArr\r\n  }\r\n});\r\n// 分页查询\r\nrouter.post('/searchArticles', async function(ctx, next){\r\n  let req = ctx.request.body\r\n  let loginSessionId = await redis.get('loginSessionId', function (err, result) {\r\n\treturn result\r\n  });\r\n  if(req.loginSessionId && req.loginSessionId === loginSessionId){\r\n\t//判断是否当前登录用户，如果是的话就可以操作\r\n\t// 定义查询条件\r\n\tlet q = {}\r\n\tif (req.title) {    //如果有搜索请求就增加查询条件\r\n\t\t//用正则表达式得到的pattern对title属性进行模糊查询\r\n\t\t//这里是搜集合里title属性包含str串的所有结果\r\n\t\tvar pattern = new RegExp(\"^.*\"+req.title+\".*$\");\r\n\t\tq.title = pattern;\r\n\t}\r\n\tlet res = await Article.find(q, function (err, art) {\r\n\treturn art\r\n    }).sort({Aid:-1}).skip((req.pageIndex - 1) * req.pageSize).limit(req.pageSize)\r\n    let total = await Article.find(q, function (err, art) {\r\n\treturn art\r\n    })\r\n    let totalLenth = total.length\r\n    let resArr = res.map((item) => {\r\n    \treturn {\r\n    \t  Aid: item.Aid,\r\n\t      createTime: item.createTime,\r\n\t      title: item.title,\r\n\t      type: item.type\r\n    \t}\r\n\t})\r\n    ctx.status = 200\r\n    ctx.body = {\r\n    \tcode: 0,\r\n    \tlist: resArr,\r\n    \ttotal: totalLenth\r\n    }\r\n  }else{\r\n\t  ctx.status = 200\r\n\t  ctx.body = {\r\n         code: -999,\r\n         errorMsg: '当前未登录，请重新登录'\r\n      }\r\n  }\t\r\n});\r\n\r\n// 查询详情\r\nrouter.post('/articleDetail', async function(ctx, next){\r\n\tlet req = ctx.request.body\r\n\t// 定义查询条件\r\n\tlet res = await Article.find({Aid:req.Aid}, function (err, art) {\r\n\treturn art\r\n\t})\r\n\tif(res && res.length>0){\r\n\t\tctx.status = 200\r\n\t    ctx.body = {\r\n\t    \tcode: 0,\r\n\t    \tarticle: res[0]\r\n\t    }\r\n\t}else{\r\n\t\tctx.status = 200\r\n\t\tctx.body = {\r\n\t       code: -1,\r\n\t       errorMsg: '查询失败'\r\n\t    }\r\n\t}\r\n});\r\n\r\n//删除文章\r\nrouter.post('/delArticles', async function(ctx, next){\r\n  let req = ctx.request.body\r\n  let loginSessionId = await redis.get('loginSessionId', function (err, result) {\r\n\treturn result\r\n  });\r\n  if(req.loginSessionId && req.loginSessionId === loginSessionId){\r\n\t//判断是否当前登录用户，如果是的话就可以操作\r\n\t// 定义查询条件\r\n\tlet res = await Article.remove({Aid:req.Aid}, function (err, art) {\r\n\treturn art\r\n    })\r\n    if(res.ok == 1){\r\n    \tctx.status = 200\r\n\t    ctx.body = {\r\n\t    \tcode: 0,\r\n\t    \terrorMsg: '删除成功',\r\n\t    }\r\n    }else{\r\n    \tctx.status = 200\r\n\t    ctx.body = {\r\n\t    \tcode: -1,\r\n\t    \terrorMsg: '删除失败',\r\n\t    }\r\n    }\r\n    \r\n  }else{\r\n\t  ctx.status = 200\r\n\t  ctx.body = {\r\n         code: -999,\r\n         errorMsg: '当前未登录，请重新登录'\r\n      }\r\n  }\t\r\n});\r\n\r\nmodule.exports = router;\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/routers/articles.js","var Router = require('koa-router')\r\nvar Redis = require('ioredis')\r\nvar redis = new Redis();\r\nvar mongoose = require('mongoose');\r\n// 引入 mongoose 配置文件\r\nvar Comment = mongoose.model('Comment');\r\nvar db = mongoose.connection;\r\ndb.on('error', console.error.bind(console, 'connection error:'));\r\ndb.once('open', function() {\r\n  console.log('mongo success')\r\n});\r\nvar router = new Router()\r\n\r\nrouter.post('/setComment', async (ctx, next) => {\r\n  let req = ctx.request.body\r\n  let nowTime = new Date;\r\n  var comment = new Comment({ \r\n    bindAid: req.bindAid,\r\n    createTime: nowTime,\r\n    text: req.text,\r\n    name: req.name\r\n  });\r\n  let saveerr = comment.save(function (err, bobo) {\r\n    if (err) return console.error(err);\r\n  });\r\n  if(saveerr){\r\n    ctx.status = 200\r\n    ctx.body = {\r\n          code: -1,\r\n          errorMsg: saveerr\r\n      }\r\n  }else{\r\n    ctx.status = 200\r\n    ctx.body = {\r\n          code: 0,\r\n          errorMsg: '评论成功'\r\n      }\r\n  }\r\n})\r\n\r\nrouter.post('/getComments', async (ctx, next) => {\r\n  let req = ctx.request.body\r\n  let res = await Comment.find({bindAid: req.bindAid}, function (err, art) {\r\n      return art\r\n    }).sort({createTime:-1})\r\n  let resArr = res.map((item) => {\r\n    return {\r\n      createTime: item.createTime,\r\n      text: item.text,\r\n      name: item.name\r\n    }\r\n  })\r\n  ctx.status = 200\r\n  ctx.body = resArr\r\n})\r\n\r\nrouter.post('/queryComments', async (ctx, next) => {\r\n  let req = ctx.request.body\r\n  let q = {}\r\n  if (req.name) {    //如果有搜索请求就增加查询条件\r\n    //用正则表达式得到的pattern对title属性进行模糊查询\r\n    //这里是搜集合里title属性包含str串的所有结果\r\n    var pattern = new RegExp(\"^.*\"+req.name+\".*$\");\r\n    q.name = pattern;\r\n  }\r\n  let res = await Comment.find(q, function (err, art) {\r\n    return art\r\n  }).sort({createTime:-1}).skip((req.pageIndex - 1) * req.pageSize).limit(req.pageSize)\r\n  let total = await Comment.find(q, function (err, art) {\r\n    return art\r\n  })\r\n  let totalLenth = total.length\r\n  let resArr = res.map((item) => {\r\n    return {\r\n      createTime: item.createTime,\r\n      text: item.text,\r\n      bindAid: item.bindAid,\r\n      name: item.name\r\n    }\r\n  })\r\n  ctx.status = 200\r\n  ctx.body = {\r\n      code: 0,\r\n      list: resArr,\r\n      total: totalLenth\r\n  }\r\n})\r\n\r\n\r\nmodule.exports = router;\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/routers/comment.js","var Router = require('koa-router')\r\nvar Redis = require('ioredis')\r\nvar redis = new Redis();\r\nvar mongoose = require('mongoose');\r\nvar codeList = require('../codeList/codeList.js')\r\n// 引入 mongoose 配置文件\r\nvar User = mongoose.model('User');\r\nvar db = mongoose.connection;\r\ndb.on('error', console.error.bind(console, 'connection error:'));\r\ndb.once('open', function() {\r\n  console.log('mongo success')\r\n});\r\nvar router = new Router()\r\n\r\nrouter.post('/userlogin', async (ctx, next) => {\r\n  console.log(ctx.request.body)\r\n  let req = ctx.request.body\r\n  let loginuser = await User.find({\"userName\": req.userName}, function (err, users) {\r\n      return users\r\n  })\r\n  if(loginuser && loginuser.length>0){\r\n    let findUser = loginuser[0]\r\n    if(findUser.passWord === req.passWord){\r\n      redis.set('loginSessionId', findUser.uid)\r\n      let loginSessionId = await redis.get('loginSessionId', function (err, result) {\r\n        return result\r\n      });\r\n      console.log(loginSessionId)\r\n      ctx.status = 200\r\n      ctx.body = {\r\n        code: 0,\r\n        errorMsg: null,\r\n        loginSessionId: findUser.uid,\r\n        userName: findUser.userName,\r\n        codeList: codeList.default\r\n      }\r\n    }else{\r\n      ctx.status = 200\r\n      ctx.body = {\r\n        code: -1,\r\n        errorMsg: '密码错误'\r\n      }\r\n    }\r\n    \r\n  }else{\r\n    ctx.status = 200\r\n    ctx.body = {\r\n      code: -1,\r\n      errorMsg: '用户不存在'\r\n    }\r\n  }\r\n  console.log(loginuser)\r\n  \r\n})\r\n\r\nrouter.post('/getusers', async (ctx, next) => {\r\n  console.log(ctx.request)\r\n  ctx.status = 200\r\n  redis.set('hello', 'this is hello')\r\n  ctx.body = await redis.get('hello', function (err, result) {\r\n    return result\r\n  });\r\n})\r\n\r\nrouter.post('/getCodeList', async function(ctx, next){\r\n  if(ctx.request.header.connection != 'close'){\r\n    ctx.status = 200\r\n    ctx.body = {\r\n      code: 0,\r\n      codeList: codeList.default\r\n    }\r\n  }\r\n});\r\n\r\nmodule.exports = router;\r\n\n\n\n// WEBPACK FOOTER //\n// ./server/routers/users.js","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"koa2-cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa2-cors\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 12\n// module chunks = 0","const codeList = {\r\n\tarticleTypeList: [{\r\n\t\tcodeKey: 'live',\r\n\t\tcodeName: '生活',\r\n\t},{\r\n\t\tcodeKey: 'javaScript',\r\n\t\tcodeName: 'javaScript',\r\n\t},{\r\n\t\tcodeKey: 'book',\r\n\t\tcodeName: '书籍',\r\n\t}]\r\n}\r\nexport default codeList\n\n\n// WEBPACK FOOTER //\n// ./server/codeList/codeList.js","var mongoose = require('mongoose');\r\n\r\nvar ArticleSchema = new mongoose.Schema({\r\n\tAid: Number,\r\n\ttitle: String,\r\n\tinnerHtml: String,\r\n\tcreateTime: Date,\r\n\ttype: String\r\n})\r\n\r\nmongoose.model('Article', ArticleSchema);\n\n\n// WEBPACK FOOTER //\n// ./server/models/article.server.model.js","var mongoose = require('mongoose');\r\n\r\nvar CommentSchema = new mongoose.Schema({\r\n\tbindAid: Number,\r\n\tcreateTime: Date,\r\n\ttext: String,\r\n\tname: String\r\n})\r\n\r\nmongoose.model('Comment', CommentSchema);\n\n\n// WEBPACK FOOTER //\n// ./server/models/comment.server.model.js","var mongoose = require('mongoose');\r\n\r\nvar UserSchema = new mongoose.Schema({\r\n\tuid: String,\r\n\tuserName: String,\r\n\tcreateTime: Date,\r\n\tlastLogin:Date,\r\n\tpassWord: String\r\n})\r\n\r\nmongoose.model('User', UserSchema);\n\n\n// WEBPACK FOOTER //\n// ./server/models/user.server.model.js","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 17\n// module chunks = 0","import Koa from 'koa'\nimport { Nuxt, Builder } from 'nuxt'\nconst cors = require('koa2-cors')\nvar bodyParser = require('koa-bodyparser');\n// 引入 mongoose 配置文件\nvar mongoose = require('./mongo/mongoose.js');\n// 执行配置文件中的函数，以实现数据库的配置和 Model 的创建等\nvar db = mongoose();\n\n//获取user路由\nvar users = require('./routers/users');\nvar articles = require('./routers/articles');\nvar comments = require('./routers/comment');\nasync function start () {\n  const app = new Koa()\n  app.use(bodyParser());\n  //配置跨域请求\n  app.use(cors({\n    origin: function(ctx) {\n      return '*';\n    },\n  }));\n\n\n  // const host = process.env.HOST || '127.0.0.1'\n  const port = process.env.PORT || 80\n\n  // Import and Set Nuxt.js options\n  let config = require('../nuxt.config.js')\n  config.dev = !(app.env === 'production')\n\n  // Instantiate nuxt.js\n  const nuxt = new Nuxt(config)\n\n  // Build in development\n  if (config.dev) {\n    const builder = new Builder(nuxt)\n    await builder.build()\n  }\n\n  const startRender = async (ctx, next) => {\n    await next()\n    ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n    return new Promise((resolve, reject) => {\n      ctx.res.on('close', resolve)\n      ctx.res.on('finish', resolve)\n      nuxt.render(ctx.req, ctx.res, promise => {\n        // nuxt.render passes a rejected promise into callback on error.\n        promise.then(resolve).catch(reject)\n      })\n    })\n  }\n\n\n  app.use(users.routes())\n  app.use(articles.routes())\n  app.use(comments.routes())\n  app.use(startRender)\n  \n    \n  app.listen(port)\n  console.log('Server listening on ' + ':' + port) // eslint-disable-line no-console\n}\n\nstart()\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js"],"sourceRoot":""}